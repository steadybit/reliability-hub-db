{
  "id": "19c0d7ae-c3a7-44ba-9892-1dff8f665deb",
  "templateTitle": "Certificate TLS/SSL expiry",
  "templateDescription": "TODO\n## Motivation\n\nTODO\n## Structure\nTODO\n## Solution Sketch\nTODO\n\n## Warning\nTODO\nPlease be aware that we will shut down a node. Please ensure this is fine and your node is either virtual or can somehow be started up afterward.",
  "placeholders": [
    {
      "key": "httpEndpoint",
      "name": "Secured HTTP Endpoint",
      "description": "### What is the secured HTTP endpoint URL that should still work in the future?\nThe HTTP endpoint should be secured with an SSL certificate to validate the certificate expiry.\nWe will perform requests before and while changing a host's time to validate that this endpoint works fine today and in the future and that the SSL certificate hasn't expired."
    },
    {
      "key": "hostname",
      "name": "Host Providing HTTP Endpoint",
      "description": "### What is the hostname of the host providing the secured HTTP endpoint?"
    },
    {
      "key": "days",
      "name": "Expiration in Days",
      "description": "### How many days in the future would you like to validate the expiry date of the certificate?"
    }
  ],
  "tags": [
    "Certificate Expiry"
  ],
  "experimentName": "TLS/SSL Certificate doesn't expire within next [[days]] for [[hostname]]",
  "hypothesis": "When a host's time is +[[days]] days, the secured HTTP endpoint should still be working and no certificates are expired.",
  "lanes": [
    {
      "steps": [
        {
          "type": "action",
          "ignoreFailure": false,
          "parameters": {
            "duration": "10s",
            "headers": [],
            "method": "GET",
            "successRate": 100,
            "maxConcurrent": 5,
            "followRedirects": false,
            "readTimeout": "5s",
            "connectTimeout": "5s",
            "requestsPerSecond": 10,
            "url": "[[httpEndpoint]]",
            "statusCode": "200-299"
          },
          "customLabel": "GIVEN: HTTP requests are valid for today",
          "actionType": "com.steadybit.extension_http.check.periodically",
          "radius": {}
        },
        {
          "type": "action",
          "ignoreFailure": false,
          "parameters": {
            "duration": "60s",
            "headers": [],
            "method": "GET",
            "successRate": 100,
            "maxConcurrent": 5,
            "followRedirects": false,
            "readTimeout": "5s",
            "connectTimeout": "5s",
            "requestsPerSecond": 10,
            "url": "[[httpEndpoint]]",
            "statusCode": "200-299"
          },
          "customLabel": "THEN: HTTP requests continue to be valid in +[[days]] days",
          "actionType": "com.steadybit.extension_http.check.periodically",
          "radius": {}
        }
      ]
    },
    {
      "steps": [
        {
          "type": "wait",
          "ignoreFailure": false,
          "parameters": {
            "duration": "10s"
          }
        },
        {
          "type": "action",
          "ignoreFailure": false,
          "parameters": {
            "offset": "[[days]]",
            "duration": "60s",
            "disableNtp": true
          },
          "customLabel": "WHEN: Host's time is +[[days]] days",
          "actionType": "com.steadybit.extension_host.timetravel",
          "radius": {
            "targetType": "com.steadybit.extension_host.host",
            "predicate": {
              "operator": "AND",
              "predicates": [
                {
                  "key": "host.hostname",
                  "operator": "EQUALS",
                  "values": [
                    "[[hostname]]"
                  ]
                }
              ]
            },
            "query": null,
            "percentage": 100
          }
        }
      ]
    }
  ]
}